function O(M,{validationHelpers:p={},rules:d,schema:o,errorMessages:h={},options:y={propertiesMustMatch:!0,abortEarly:!1}}){let u={},r=M,l={all:async e=>Promise.all([...e].map(async s=>await v(s,r))),first:async e=>{let s=[];for(let t of e){let i=await v(t,r);if(s.push(i),!i)return s}return s}};function c(e,s){if(!e||typeof s!="string")return;let t=s.split("."),i=e;for(let g of t){if(i[g]===void 0)return;i=i[g]}return i}async function v(e,s=null){if(o[e.key]){let{rule:t,required:i}=o[e.key];if((t&&i||!i&&e.value!="")&&t){let g=t.split("--")[0],a=t.split("--").length>1?t.split("--")[1]:"",m=q(e.value,d[g],a,p,s),{isValid:w,errorMessage:R,errorType:V}=await m.validate();return w||(u[e.key]={name:e.key,error:!0,errorMessage:c(h,R)||R,errorType:V}),w}}else if(y.propertiesMustMatch)return u[e.key]={name:e.key,error:!0,errorMessage:"Invalid property"},!1;return!0}async function k(e){return await v({key:e,value:r[e]},r)?{ok:!0}:{error:!0,errors:u[e]}}async function n(){u={};let e=Object.keys(r).map(s=>({key:s,value:r[s]}));if(e&&e.length>0){if(!Object.keys(o).every(a=>r.hasOwnProperty(a)))return{error:!0,errorMessage:"Missing properties"};if((y?.abortEarly?await l.first(e):await l.all(e)).some(a=>!a))return{error:!0,errors:u};let t=Object.keys(o).map(a=>({key:a,required:o[a].required})),i=e.map(a=>a.key);if(!t.filter(a=>a.required).map(a=>a.key).every(a=>i.includes(a)))return{error:!0}}else if(!e||e.length===0)return{error:!0,errorMessage:"Missing fields for schema"};return{ok:!0}}function f(e){r=e}return{validate:n,validateField:k,setData:f}}function q(M,p,d=null,o=null,h=null){async function y(r){let l,c;return{isValid:!(await Promise.all(r.validate.map(async n=>{let f=!0;if(r.params&&r.params[n]&&r.params[n].length>0){let e=r.params[n].map(t=>typeof t=="string"&&t[0]==="$"?t.substring(1,t.length):t);f=await this[n](...e)}else f=await this[n]();return!f&&!l&&r?.error[n]&&(l=r.error[n],c=n),f}))).some(n=>!n),errorMessage:l,errorType:c}}async function u(){if(o&&typeof o=="function"){let l=o(M,p,d,h);Object.keys(l).forEach(c=>{this[c]=l[c]})}return d?await y.call(this,p.modifier[d]):await y.call(this,p)}return{validate:u}}export{O as createValidator};
